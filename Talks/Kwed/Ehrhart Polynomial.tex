\documentclass[12pt]{article}
\usepackage{import}
\import{"../../Algebraic Geometry/"}{AlgGeoCommands}

\begin{document}

\section{The Ehrhart Polynomial}

\newcommand{\Cone}{\mathrm{Cone}}
\newcommand{\Vol}[2]{\mathrm{Vol}_{#1}\left( #2 \right)}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Rat}[1]{\mathrm{Rat}\left(#1\right)}
\newcommand{\inner}[2]{\left< #1, #2 \right>}



\begin{theorem}[Ehrhart Polynomial]
Let $P$ be an $n$-dimensionaly lattice polytope in $\R^n$. Then there exists a unique polynomial with rational coefficients $E_P \in \Q[x]$ ssatsfying:
\begin{enumerate}
\item For any integer $\nu \in \N$,
\[ E_P(\nu) = \# \left( (\nu P) \cap M \right) \]
\item The leading coefficient of $E_P$ is $\Vol{}{P}$ i.e. the volume of $P$ normalized to the lattice cell volume of $M$.
\item There is a reciprocity law for positive integers $\nu > 0$,
\[ E_P(-\nu) = (-1)^d \# \left( \nu P^\circ \cap M \right) \] 
\end{enumerate} 
\end{theorem}


\begin{remark}
To prove the power of this theorem, we can easily derive the classical Pick's theorem as a special case.
\end{remark}

\begin{theorem}[Pick]
Let $n = 2$ and $P \subset \R^2$ be a lattice polygon. Then,
\[ \# (P \cap M) = \Vol{M}{P} + \tfrac{1}{2} \# (\partial P \cap M) + 1 \] 
\end{theorem}

\begin{proof}
Consider the Ehrhart polynomial which takes the form,
\[ E_P(x) = \Vol{M}{P} x^2 + B x + 1 \]
Now we can decompose $P = P^\circ \cup \partial P$ which implies that,
\[ E_P(1) = \# \left( P \cap M \right) = \# \left( P^\circ \cap M \right) + \# \left( \partial P \cap M \right) \]
Furthermore, by the reciprocity law,
\[ E_P(-1) = \# \left( P^\circ \cap M \right) \]
Putting these together, we find,
\[ E_P(1) - E_P(-1) = \# \left( \partial P \cap M \right) \]
However, applying the polynomial form,
\[ E_P(1) - E_p(-1) = 2 B \implies B = \tfrac{1}{2} \# \left( \partial P \cap M \right) \]
Thus the Ehrhart polynomial is,
\[ E_P(x) = \Vol{M}{P} x^2 + \tfrac{1}{2} \# \left( \partial P \cap M \right) x + 1 \]
Which, for $x = 1$ we find,
\[ E_P(1) = \# \left( P \cap M \right) = \Vol{M}{P} + \tfrac{1}{2} \# \left( \partial P \cap M \right)  + 1 \]
giving Pick's formula. 
\end{proof}

\section{Construction of the Toric Variety}

Let $N = \# (P \cap \Z^n) - 1$. Then consider the map $(\CC^\times)^n \embed \P^N$ defined by sending,
\[ \underline{t} \mapsto [\underline{t}^{\underline{v}_0} : \cdots : \underline{t}^{\underline{v}_N}] \]
for the lattice poitns $\underline{v}_i \in P \cap \Z^n$. Then we define the toric variety $X_P$ to be the closure of the image of this map. The additional points are called the boundary strata and can be shown to also be rational varities of lower dimensions. (Note, if $P$ does not have ``enough lattice points'' then this construction does not work because the associated divisor is only ample not very ample but this does work replacing $P$ by $\nu P$ for $\nu \gg 0$ and then mucking around with divisors to return to counting points for the divisor $P$. Alternatively, one can construct $X_P$ intrinsically from the combinatorial data of $P$ in a way that is manifestly independent of scaling).
\bigskip\\
Furthermore, notice that the embedding $(\CC^\times)^n \embed \P^N$ is equivariant for the following action $(\CC^\times)^n \acts \P^N$ given by,
\[ \underline{t} \cdot [z_0 : \cdots : z_N] = [\underline{t}^{\underline{v}_0} z_0 : \cdots : \underline{t}^{\underline{v}_N} z_N] \]
Therefore, we get an action $(\CC^\times)^n \acts X_P$ extending the standard left action of the torus $(\CC^\times)^n \subset X_P$. Because the embedded torus $(\CC^\times)^n \subset X_P$ is a dense open, the function field which is the field of meromorphic functions on $X_P$, is equal to that of $(\CC^\times)^n$ which is,
\[ K(X_P) = \CC(\chi_1, \dots, \chi_n) \] 
These are generated by rational functions $\chi_i : (\CC^\times)^n \to \CC^\times$ which are the standard characters $\underline{t} \mapsto t_i$. We call functions of the form $\chi^u = \chi_1^{u_1} \cdots \chi_n^{u_n}$ characters because they are exactly the set of group homomorphisms. 
\bigskip\\
We now consider the structure of the boundary strata and how these characters behave at the boundary. Let's consider a polynomial map $\lambda : \CC^\times \to (\CC^\times)^n$. Let $e_i$ be the maximum exponent of $\lambda$ of $\chi_i \circ \lambda$. Then we see that under the embedding,
\[ \lim_{t \to \infty} \lambda(t) = \lim_{t \to \infty} [c_1 t^{\underline{e} \cdot \underline{v}_1} : \cdots : c_N t^{\underline{e} \cdot \underline{v}_N}] \]
Therefore, after rescaling, the only remaining terms are the maximum values of $\underline{e} \cdot \underline{v}_i$. The indices that show up as maximum values in the direction $\underline{e}$ are the extreme shapes of $P$. Therefore, we get a correspondence between the strata and the faces of $P$. Furthermore, consider,
\[ \lim_{t \to \infty} \chi^u \circ \lambda(t) = t^{u \cdot \underline{e}} \]
so the order of the pole of $\chi^u$ on the boundary strata $D_e$ defined by $e$ is $u \cdot \underline{e}$. In particular, the character $\chi^u$ has a pole on the boundary strata defined by a direction $\underline{e}$ if and only if $u \cdot \underline{e} > 0$ and has a zero if and only if $u \cdot \underline{e} < 0$. Note, this really only makes sense for top-dimensional boundary strata (corresponding to facets: top dimensional faces of $P$) because a zero or pole of a rational function only makes sense on a codimension $1$ subset. For example, consider $f(x,y) = \frac{x}{y}$ on $\CC^2$. This has a pole on the $x$-axis and a zero on the $y$-axis so what is its value at the origin?? Indeed, it has a different limit depending on if you approach the origin along the $x$ or $y$ axis. 
\bigskip\\
Now notice the following. If we write decompose our polytope into half-spaces defined by the facets,
\[ P = \bigcap_{F \subset P} H^+(u_F, a_F) \quad \text{ where } \quad H^+(u, a) = \{ x \in \RR^n \mid x \cdot u \le a \} \]
Then notice that $u \in P \cap \Z^n$ if and only if $\chi^u$ has a pole of no worse than order $a$. Therefore, we should define $\L_P$ to be the line bundle of functions with poles along the strata $D_F$ no worse than order $a_F$. Because $D_F$ are torus-invariant and the torus acts on the function field we see that $\L_P$ is equivariant for the torus and therefore its space of sections is spanned by eigensections for the torus action which are exactly characters. Therefore, we conclude that,
\[ H^0(X_P, \L_P) = \bigoplus_{u \in P \cap \Z^n} \CC \cdot \chi^u \]
Notice that we can describe any other polytope with the same facet normals as $P$ in a similar way just by chaning the pole behavior on the boundary strata. For a tuple of integers $q = (q_F)$ let,
\[ P(q) = \bigcap_{F \subset P} H^+(u_F, q_F) \]
and we associate a line bundle $\L_q = \L_{P(q)}$ which we also write in divisor notation as,
\[ \L_q = \struct{X_P}(\sum_{F \subset P} q_F D_F) \]
Then the same argument shows that,
\[ H^0(X_P, \L_q) = \bigoplus_{u \in P(q) \cap \Z^n} \CC \cdot \chi^u \]

\begin{thm}[Demazure]
For $i > 0$ the cohomology,
\[ H^i(X_P, \L_{P(q)}) = \bigoplus_{u \in P \cap \Z^n} \CC \cdot \chi^u \]
and therefore,
\[ \chi(X_P, \L_{P(q)}) = \# (P \cap \Z^n) \]
\end{thm}

\section{The Proof}

\begin{proof}
Given the lattice polytope $P$ we have constructed a toric variety $X_P$ with a divisor $D_P$ such that,
\[ \chi(X_P, \struct{X_P}(D_P)) = \# (P \cap \Z^n) \]
By the Hirzbruch-Riemann-Roch theorem we have,
\[ \chi(X_P, \struct{X_P}(\nu D_P)) = \int_{X_P} \mathrm{ch}(\struct{X_P}(\nu D_P)) \: \mathrm{Td}(\mathcal{T}_{X_P}) \]
Recall that the Chern character is,
\[ \mathrm{ch}(\struct{X_P}(\nu D_P)) = \exp{(c_1(\struct{X_P}(\nu D_P)))} = \sum_{m = 0}^d \frac{c_1(\struct{X_P}(\nu D_P))^m}{m!} \] 
where the sum terminates at $d = \dim{X_P}$ since higher intersections vanish. Recall that the Chern class $c_1$ is a homomorphism $c_1(\L_1 \otimes \L_2) = c_1(\L_1) + c_1(\L_2)$. Thus, since $\struct{X_P}(\nu D_P) = \struct{X_P}(D_P)^{\otimes \nu}$,
\[ \mathrm{ch}(\struct{X_P}(\nu D_P)) = \sum_{m = 0}^d \frac{c_1(\struct{X_P}(D_P)^{\otimes \nu})^m}{m!} =  \sum_{m = 0}^d c_1(\struct{X_P}(D_P))^m \frac{\nu^m}{m!} \] 
Therefore,
\begin{align*}
\chi(X_P, \struct{X_P}(\nu D_P)) & = \int_{X_P} \left( \sum_{m = 0}^d c_1(\struct{X_P}(D_P))^m \frac{\nu^m}{m!} \right) \: \mathrm{Td}(\mathcal{T}_{X_P}) 
\\
& = \sum_{m = 0}^d \frac{\nu^m}{m!} \left( \int_{X_P} c_1(\struct{X_P}(D_P))^m \: \mathrm{Td}(\mathcal{T}_{X_P}) \right) = h(\nu) 
\end{align*}
is a degree at most $d$ polynomial in $\nu$. This implies that for $\nu \in \N$ we have proven there is a polynomial,
\[ E_P(\nu) = h(\nu) = \chi(X_P, \struct{X_P}(\nu D_P)) = \dim_{\CC} H^0(X_P, \struct{X_P}(\nu D_P)) = \# \left( \nu P \cap \Z^n \right) \]
Furthermore, since $D_P$ is big and $E_P(m)$ counts sections of $\struct{X_P}(m D_P)$, we know that the leading term must be $m^d$ so $\deg{E_P} = d$. Writing,
\[ E_P(x) = a_n x^n + \cdots + a_0 \]
we may isolate the leading coefficient as follows,
\[ a_n = \lim_{\nu \to \infty} \frac{E_P(\nu)}{\nu^d} = \lim_{\nu \to \infty} \frac{\# \left( \nu P \cap M \right)}{\nu^d} = \Vol{M}{P} \] 
Lastly, to prove the duality property, we apply Serre duality. On $X_P$, the dualizing sheaf is equal to the canonical sheaf,
\[ \omega_{X_P} = \struct{X_P}( - \sum_F D_F) \]
where $D_F$ is the divisor $V(\sigma_F)$ for each facet $F \subset P$. Since $X_P$ is a projective Cohenâ€“Macaulay variety (and thus irreducible over $k$), Serre duality sates that, for any locally free sheaf $\F$ on $X_P$,
\[ H^i(X_P, \F^\vee) = H^{d - i}(X_P, \F \otimes_{\struct{X_P}} \omega_{X_P})^\vee \]
which, by computing dimensions and reordering, implies that,
\[ \chi(X_P, \F^\vee) = (-1)^d \chi(X_P, \F \otimes_{\struct{X_P}} \omega_{X_P}) \]
In particular, for $\F = \struct{X_P}(\nu D_P)$ we have,
\[ E_P(-\nu) = \chi(X_P, \struct{X_P}(- \nu D_P)) = (-1)^d \chi(X_P, \struct{X_P}(\nu D_P) \otimes_{\struct{X_P}} \omega_{X_P}) \]
By the Kodaria vanishing theorem, since $\nu D_P$ is ample for $\nu > 0$, 
\[ \chi(X_P, \struct{X_P}(\nu D_P) \otimes_{\struct{X_P}} \omega_{X_P}) = \dim_\C H^0(X_P, \struct{X_P}(\nu D_P) \otimes_{\struct{X_P}} \omega_{X_P}) \]
Now we consider the invertible sheaf,
\[ \struct{X_P}(\nu D_P) \otimes_{\struct{X_P}} \omega_{X_P} = \struct{X_P}(\nu D_P - \sum_F D_F) = \struct{X_P}(\sum_F (\nu a_F - 1) D_F) \]
which means we should consider the divisor,
\[ D' = \sum_F (\nu a_F - 1) D_F \]
which corresponds to the support function $\psi_{D'}$ satisfying $\psi_{D'}(n_F) = -(\nu a_F - 1)$ (recall that cones $\rho \in \Sigma_P(1)$ correspond to facets $F \subset P$). Therefore, the polytope for the divisor $D'$ is,
\[ P_{D'} = \bigcap_{\substack{F \subset P \\ \text{a facet}}} H^+(n_F, \psi_{D'}(n_F)) = \bigcap_{\substack{F \subset P \\ \text{a facet}}} H^+(n_F, 1 - \nu a_F) \]
Recall that,
\[ \nu P = \bigcap_{\substack{F \subset P \\ \text{a facet}}} H^+(n_F, -a_F) = \bigcap_{\substack{F \subset P \\ \text{a facet}}} \{ x \in M_\R \mid \forall F : \inner{x}{n_F} \ge - \nu a_F \} \]
Therefore, the interior is,
\[ \nu P^\circ  = \bigcap_{\substack{F \subset P \\ \text{a facet}}} \{ x \in M_\R \mid \forall F : \inner{x}{n_F} > - \nu a_F \} \]
Therefore, intersecting with the lattice,
\[ \nu P^\circ \cap M = \bigcap_{\substack{F \subset P \\ \text{a facet}}} \{ m \in M \mid \forall F : \inner{m}{n_F} \ge - \nu a_F + 1 \} = P_{D'} \cap M \]
because the inner product is integer valued on the lattice so,
\[ \inner{m}{n_F} > - \nu a_F \iff \inner{n}{n_F} \ge - \nu a_F + 1 \]
Thus,
\[ E_P(-\nu) = (-1)^d \dim_{\C} H^0(X_P, \struct{X_P}(D')) = (-1)^d \# \left( P_{D'} \cap M \right) = (-1)^d \# \left( \nu P^\circ \cap M \right) \]
\end{proof}

\begin{remark}
Note that $E_P(0) = \#((0 \cdot P) \cap M) = 1$ so the constant term is $1$. Furthermore, in the limit $\nu \to \infty$ if $\dim{P} = d$ then $E_P(\nu) \in O(\nu^d)$ so $\deg{E_P} = d$.  
\end{remark}


\end{document}
